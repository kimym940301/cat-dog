# 개와 고양이로 나누기 위한 CNN 이미지 분류
## 캐글(Kaggle)의 개 고양이 이미지 분류 대회는 이미지 데이터셋을 이용한 딥러닝 모델링 경진대회입니다.

# 전처리
 
### 개 이미지 12,500개, 고양이 이미지 12,500개를 train/validation/test 용으로 분리하고, tensorflow의 ImageDataGenerator를 사용할 것이기 때문에 각 라벨(cat,dog)를 폴더별로 따로 분리하도록 하겠습니다.
 - ImageDataGenerator란 이미지 데이터 처리를 위한 유틸리티 클래스입니다. 이 클래스는 이미지 데이터에 대한 다양한 변환 및 증강 기능을 제공합니다. 이를 통해 모델의 학습 데이터를 늘리거나, 이미지의 다양한 특징을 추출하는 등의 작업을 수행할 수 있습니다. 이 클래스는 회전, 확대/축소, 가로/세로 이동, 반전, 밝기 조절 등의 기능을 제공하며 다양한 인자를 통해 이미지 변환 방법을 지정할 수 있습니다.

# 모델링
 - 처음 이미지의 크기를 (255, 255)로 가정하고,RGB 이미지를 처리하기 때문에 입력 채널의 개수는 3이며, 모델의 첫 번째 레이어는 8개의 필터를 사용하는 3x3 크기의 컨볼루션 레이어이며, ReLU 활성화 함수를 사용합니다.
 - Conv2D에서 추출된 특징 맵의 크기를 줄이고 모델의 일반화 성능을 향상시키기 위해여 다음으로 맥스 풀링(Max Pooling) 레이어를 추가 했습니다.
 - Conv2D 와 maxpooling을 반복하여 특징을 추출해 특징을 강조하고 크기를 줄여 비용 계산을 절감했습니다. 
 - Flatten 레이어를 추가하면서, 이전 레이어의 출력값이 1차원 벡터로 변환되어, 다음 레이어에서 사용할 수 있게 됩니다
 - Dense 레이어가 두 개 추가되어 있습니다. 첫 번째 Dense 레이어는 32개의 뉴런(neuron)을 가지고, 활성화 함수(activation function)로 ReLU 함수를 사용합니다. 이 레이어는 전체 입력 벡터를 32개의 출력 벡터로 변환하는 과정을 수행합니다.
 - ReLu는 입력값이 양수이면 그대로 출력하고, 음수이면 0을 출력하는 함수입니다. 비선형성을 가지며, 출력값이 항상 0 또는 양수이기 때문에 신경망의 학습 능력을 향상시키는 역할을 합니다. 또한, 연산이 간단하고 계산 속도가 빠르기 때문에 다른 활성화 함수보다 더 빠르게 학습할 수 있습니다.
 - 이후 Dropout을 추가 해줬습니다. Dropout은 랜덤하게 선택된 일부 뉴런을 무시하도록 만들어, 모델이 특정 뉴런에 과도하게 의존하지 않도록 합니다. 
 - 마지막 Dense 레이어는 입력 이미지가 개인지 고양이인지 이진 분류하는 작업을 담당하며, sigmoid 함수를 활성화 함수로 사용하여 출력값이 0.5 이상이면 개로 분류하고 0.5 미만이면 고양이로 분류합니다. 
 - 모델의 compile은 optimizer = "adam", loss = "binary_crossentropy", metrics = "accuracy"로 설정하였습니다.
 
# 최적화
 - 기존 이미지 크기(255,255)에서 (128,128)로 줄여서 모델 학습에 필요한 계산량이 줄어들어 학습 속도가 빨라지게 했습니다.
 - 처음 Covd2D 다음 MaxPool(2)을 제거하므로 이미지의 공간적인 정보를 좀 더 획득하게 했습니다.
 - 모델링중 과적합이 발생하여 추가적으로 Dropout을 추가했습니다.
 - 중간 활성화 함수(activation function)의 ReLU 함수를 Leaky ReLU로 변경하였습니다. 그 이유는 ReLU(Rectified Linear Unit) 함수는 입력값이 0보다 작으면 출력값이 0이 되고, 0보다 큰 경우에는 입력값을 그대로 출력합니다. 이 때, 입력값이 음수인 경우에는 그대로 출력하기 때문에 'dying ReLU' 문제가 발생할 수 있습니다. 반면 Leaky ReLU(Leaky Rectified Linear Unit) 함수는 입력값이 음수일 경우에도 작은 양수 값을 출력합니다. 이 작은 양수 값을 출력함으로써 'dying ReLU' 문제를 완화할 수 있습니다. 
 - 이 작업들을 반복하여 좀 더 나은 모델을 구축하였습니다.
 
 # 최종
 - 베이스 모델 : 0.36311 - 887등
 - 최종 모델 : Score: 0.19314 - 776등
